(this["webpackJsonptest-app"]=this["webpackJsonptest-app"]||[]).push([[0],{14:function(e,t,a){"use strict";a.r(t);var o=a(1),n=a.n(o),r=a(4),i=a.n(r),c=a(2),l=function(){var e=window.location.pathname;if(e.includes("/archive/objects/")){var t=e.indexOf("/archive/objects/"),a=(e=e.slice(t+"/archive/objects/".length,e.length)).indexOf("/");return-1===a?e:e.slice(0,a)}var o=(e=e.slice(1,e.length)).indexOf("/");return-1===o?e:e.slice(0,o)},s=function(e){return JSON.parse(JSON.stringify(e))},d=function(e){var t=e.widgetDef,a=e.setWidgetData;return n.a.useEffect((function(){t.lifecycle=t.lifecycle?t.lifecycle:"develop";var e=t.lifecycle;if(t.dataSourcesSpec){if("develop"===e&&console.debug("GamsWidget-DataProvider: dataSourceSpecification provided for the widget: ",t),t.dataSourcesSpec.sources.length>1)throw new RangeError("GamsWidget currently supports exactly one source inside the widgetDef.dataSourceSpec.sources array. Make sure to pass in the correct count.");var o=t.dataSourcesSpec.sources[0];if(!u(o))return console.error("GamsWidget-DataProvider: Validation of data source object failed. Aborting operations: ",o);if(o.gamsDigitalObj){var n=o.gamsDigitalObj.pid?o.gamsDigitalObj.pid:l(),r="".concat(window.location.origin,"/archive/objects/").concat(n),i="";if(o.gamsDigitalObj.datastream&&o.gamsDigitalObj.service)return console.error("GamsWidget-DataProvider: Got a dataSource object where both a datastream and a service is defined. Please make sure to define either one: ",o);if(o.gamsDigitalObj.datastream)i=r+"/datastreams/".concat(o.gamsDigitalObj.datastream,"/content");else switch(o.gamsDigitalObj.contentModel){case"GML":i=r+"/methods/sdef:GML/".concat(o.gamsDigitalObj.service?o.gamsDigitalObj.service:"getJSON");break;case"TEI":i=r+"/methods/sdef:TEI/".concat(o.gamsDigitalObj.service?o.gamsDigitalObj.service:"get");break;case"Context":i=r+"/methods/sdef:Context/".concat(o.gamsDigitalObj.service?o.gamsDigitalObj.service:"get");break;case"Query":i=r+"/methods/sdef:Query/".concat(o.gamsDigitalObj.service?o.gamsDigitalObj.service:"getJSON");break;default:return console.error("GamsWidget-DataProvider: Unsupported-ContentModel-Error at building the request url for specified content model: ",o.gamsDigitalObj.contentModel,o)}"develop"===e&&console.debug("GamsWidget-DataProvider: Sending request for widget data to the dataspecification to: ",i),fetch(i).then((function(n){n.json().then((function(o){var n=s(t);n.data=o,"develop"===e&&console.debug("GamsWidget-DataProvider: Succesfully got data - setting now data property of widget definition. Got data: ",o),a(n)})).catch((function(e){console.error("GamsWidget-DataProvider: Error parsing data as JSON from datasource: ",o),console.error(e)}))})).catch((function(e){console.error("GamsWidget-DataProvider: Error getting data from url: ",i),console.error(e)}))}}else"develop"===e&&console.debug("GamsWidget-DataProvider: No dataSourceSpec provided for the widget - Assuming not needed for widget definition: ",t),a(s(t))}),[t,a]),null},u=function(e){var t=Object.values(e).filter((function(e){return e||!1}));return 1===t.length?(console.info("GamsWidget-DataProvider: Validation of Datasource successfull: ",e),!0):0===t.length?(console.error("GamsWidget-DataProvider: All properties of given DataSource validated false. Please make sure to assign one correct property to the given datasource object: ",e),!1):(console.error("GamsWidget-DataProvider: More than one property is defined in given datasource. Make sure to define only one: ",e),!1)},g=function(e){var t=e.setDefinition,a=void 0===t?void 0:t,o=e.children,r=void 0===o?void 0:o,i=e.globalPropName,c=e.datastream,s=e.objectPidRef;return n.a.useEffect((function(){if(a){if(window[i])return a(window[i]);var e=s||l();if(c){var t="".concat(window.location.origin,"/archive/objects/").concat(e,"/datastreams/").concat(c,"/content");fetch(t).then((function(e){e.text().then((function(e){try{a(JSON.parse(e))}catch(t){}})).catch((function(e){console.error("GamsWidget- WidgetDefProvider: Error stringifying the datastream at: ",t),console.error(e)}))})).catch((function(e){console.error("GamsWidget- WidgetDefProvider: Error at getting config data from url: ",t),console.error(e)}))}else{console.error("GamsWidget- WidgetDefProvider: No global window property nor datastream defined for retrieving the widget's definition. Returning dummy-definition instead. (But the app might crash).");var o={name:"Dummy-Test Widget",lifecycle:"develop"};console.error("GamsWidget- WidgetDefProvider: Set dummy definition: ",o),a(o)}}}),[a,i,c,s]),r||null},f=function(e){var t=e.WidgetDefProvider,a=e.WidgetDataProvider,o=e.globalPropName,r=e.datastream,i=e.children,l=n.a.useState(void 0),s=Object(c.a)(l,2),u=s[0],f=s[1],m=n.a.useState(void 0),p=Object(c.a)(m,2),v=p[0],h=p[1];return n.a.useEffect((function(){if(!n.a.Children.only(i))throw new TypeError("More ore less than one child was passed down to <GamsWidget/>. Please make sure to place exactly one component as GamsWidget component.");u&&(u.lifecycle?"develop"!==u.lifecycle&&"production"!==u.lifecycle||console.debug("GamsWidget: WidgetDefinition's lifecycle was configured as:'",u.lifecycle,"' Set the lifecycle to 'deploy' if you want to remove the console messages."):console.debug("GamsWidget: WidgetDefinition's lifecycle not set. Defaulting to:'develop'. Set the lifecycle to 'deploy' if you want to remove the console messages."))}),[u]),n.a.createElement(n.a.Fragment,null,n.a.cloneElement(i,{widgetDef:v}),t?n.a.createElement(t.Component,Object.assign({},t.props,{globalPropName:o,datastream:r,setDefinition:f})):n.a.createElement(g,{setDefinition:f,globalPropName:o,datastream:r}),u?a?n.a.createElement(a.Component,Object.assign({widgetDef:u,setWidgetData:h},a.props)):n.a.createElement(d,{widgetDef:u,setWidgetData:h}):null)},m=a(6),p=function(e){var t=e.onClick;return n.a.createElement("div",{onClick:t,className:"popup-component--popup-backdrop"})},v=function(e){var t=e.visible,a=e.togglePopup,o=e.children,r=Object(m.a)(e,["visible","togglePopup","children"]);return t?n.a.createElement(n.a.Fragment,null,n.a.createElement(p,{onClick:a}),n.a.createElement("div",Object.assign({className:"popup-component--popup-main"},r),n.a.createElement("span",{className:"popup-component--popup-close",onClick:a}),o)):null},h=(a(12),a(13),a(0)),D=a(5),b=function(e){var t=e.calendarEvents,a=void 0===t?void 0:t,o=e.defaultView,r=void 0===o?"dayGridMonth":o,i=e.defaultDate,c=void 0===i?Date.now():i,l=e.children,s=void 0===l?void 0:l,d=e.handleEventClick,u=void 0===d?void 0:d;return n.a.useEffect((function(){var e=document.getElementById("calendar");if(!e)throw new ReferenceError("No Calendar el found!");new h.a(e,{plugins:[D.a],defaultView:r,defaultDate:c,eventClick:u?function(e){return u(e)}:void 0,events:a}).render()}),[]),n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"App","data-test":"component-app"},n.a.createElement("div",{id:"calendar"})),s)},E=function(e){var t=e.widgetDef,a=n.a.useState(!1),o=Object(c.a)(a,2),r=o[0],i=o[1],l=n.a.useState(void 0),s=Object(c.a)(l,2),d=s[0],u=s[1];return t&&t.gui?n.a.createElement(n.a.Fragment,null,n.a.createElement(b,{calendarEvents:t.data?t.data.events:void 0,defaultDate:t.gui.startDate,handleEventClick:function(e){return function(e){var t=e.event.extendedProps.popupData;u(t),i(!0)}(e)}},d?n.a.createElement(v,{togglePopup:function(){return i(!r)},visible:r},n.a.createElement("div",null,n.a.createElement("h2",null,d.title),n.a.createElement("ul",null,d.list.map((function(e,t){return n.a.createElement("li",{key:"".concat(e.text,"_").concat(t)},n.a.createElement("span",null,e.text," "),n.a.createElement("a",{href:e.link.href},e.link.text))}))))):null)):null},w=function(){return n.a.createElement(f,{datastream:"GAMS_WIDGET_CALENDAR",globalPropName:"GAMS_WIDGET_CALENDAR"},n.a.createElement(E,null))};i.a.render(n.a.createElement(w,null),document.getElementById("GAMS_WIDGET_CALENDAR"))},7:function(e,t,a){e.exports=a(14)}},[[7,1,2]]]);
//# sourceMappingURL=main.1b99e861.chunk.js.map