(this["webpackJsonptest-app"]=this["webpackJsonptest-app"]||[]).push([[0],{11:function(e,t,a){e.exports=a(30)},30:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(7),l=a.n(o),i=a(1),c=a(5),u=a.n(c),s=a(8),d=function(){var e=window.location.pathname;if(e.includes("/archive/objects/")){var t=e.indexOf("/archive/objects/"),a=(e=e.slice(t+"/archive/objects/".length,e.length)).indexOf("/");return-1===a?e:e.slice(0,a)}var n=(e=e.slice(1,e.length)).indexOf("/");return-1===n?e:e.slice(0,n)},f=function(e){return JSON.parse(JSON.stringify(e))},m=function(e){var t=e.widgetDef,a=e.setWidgetData;return r.a.useEffect((function(){t.lifecycle=t.lifecycle?t.lifecycle:"develop";var e=t.lifecycle;if(t.dataSourcesSpec){"develop"===e&&console.debug("GamsWidget-DataProvider: dataSourceSpecification provided for the widget: ",t),Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.dataSourcesSpec.sources.forEach((function(e){}));case 1:case"end":return e.stop()}}),e)})))();var n=t.dataSourcesSpec.sources[0];if(!p(n))return console.error("GamsWidget-DataProvider: Validation of data source object failed. Aborting operations: ",n);if(n.gamsDigitalObj){var r=n.gamsDigitalObj.pid?n.gamsDigitalObj.pid:d(),o="".concat(window.location.origin,"/archive/objects/").concat(r),l="";if(n.gamsDigitalObj.datastream&&n.gamsDigitalObj.service)return console.error("GamsWidget-DataProvider: Got a dataSource object where both a datastream and a service is defined. Please make sure to define either one: ",n);if(n.gamsDigitalObj.datastream)l=o+"/datastreams/".concat(n.gamsDigitalObj.datastream,"/content");else switch(n.gamsDigitalObj.contentModel){case"GML":l=o+"/methods/sdef:GML/".concat(n.gamsDigitalObj.service?n.gamsDigitalObj.service:"getJSON");break;case"TEI":l=o+"/methods/sdef:TEI/".concat(n.gamsDigitalObj.service?n.gamsDigitalObj.service:"get");break;case"Context":l=o+"/methods/sdef:Context/".concat(n.gamsDigitalObj.service?n.gamsDigitalObj.service:"get");break;case"Query":l=o+"/methods/sdef:Query/".concat(n.gamsDigitalObj.service?n.gamsDigitalObj.service:"getJSON");break;default:return console.error("GamsWidget-DataProvider: Unsupported-ContentModel-Error at building the request url for specified content model: ",n.gamsDigitalObj.contentModel,n)}"develop"===e&&console.debug("GamsWidget-DataProvider: Sending request for widget data to the dataspecification to: ",l),fetch(l).then((function(r){r.json().then((function(n){var r=f(t);r.data=n,"develop"===e&&console.debug("GamsWidget-DataProvider: Succesfully got data - setting now data property of widget definition. Got data: ",n),a(r)})).catch((function(e){console.error("GamsWidget-DataProvider: Error parsing data as JSON from datasource: ",n),console.error(e)}))})).catch((function(e){console.error("GamsWidget-DataProvider: Error getting data from url: ",l),console.error(e)}))}}else"develop"===e&&console.debug("GamsWidget-DataProvider: No data provided for the widget - Assuming not needed for widget definition: ",t),a(f(t))}),[t,a]),null},p=function(e){var t=Object.values(e).filter((function(e){return e||!1}));return 1===t.length?(console.info("GamsWidget-DataProvider: Validation of Datasource successfull: ",e),!0):0===t.length?(console.error("GamsWidget-DataProvider: All properties of given DataSource validated false. Please make sure to assign one correct property to the given datasource object: ",e),!1):(console.error("GamsWidget-DataProvider: More than one property is defined in given datasource. Make sure to define only one: ",e),!1)},g=function(e){var t=e.setDefinition,a=void 0===t?void 0:t,n=e.children,o=void 0===n?void 0:n,l=e.globalPropName,i=e.datastream,c=e.objectPidRef;return r.a.useEffect((function(){if(a){if(window[l])return a(window[l]);var e="context"===c?"context:".concat(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d(),t="",a=e.indexOf(":"),n=(t=e.slice(a+1,e.length)).indexOf(".");return-1===n?t:t.slice(0,n)}()):d();if(i){var t="".concat(window.location.origin,"/archive/objects/").concat(e,"/datastreams/").concat(i,"/content");fetch(t).then((function(e){e.text().then((function(e){try{console.debug("GamsWidget-WidgetDefinitionProvider: No window-object definition provided. Defaulted to requesting current object's datastream at url: ",t),a(JSON.parse(e))}catch(n){}})).catch((function(e){console.error("GamsWidget- WidgetDefProvider: Error stringifying the datastream at: ",t),console.error(e)}))})).catch((function(e){console.error("GamsWidget- WidgetDefProvider: Error at getting widget definition from url: ",t),console.error(e)}))}else{console.error("GamsWidget- WidgetDefProvider: No global window property nor datastream defined for retrieving the widget's definition. Returning dummy-definition instead. (But the app might crash).");var n={name:"Dummy-Test Widget",lifecycle:"develop"};console.error("GamsWidget- WidgetDefProvider: Set dummy definition: ",n),a(n)}}}),[a,l,i,c]),o||null},v=function(e){var t=e.WidgetDefProvider,a=e.WidgetDataProvider,n=e.globalPropName,o=e.datastream,l=e.children,c=r.a.useState(void 0),u=Object(i.a)(c,2),s=u[0],d=u[1],f=r.a.useState(void 0),p=Object(i.a)(f,2),v=p[0],h=p[1];return r.a.useEffect((function(){if(!r.a.Children.only(l))throw new TypeError("More ore less than one child was passed down to <GamsWidget/>. Please make sure to place exactly one component as GamsWidget component.");s&&(s.lifecycle?"develop"!==s.lifecycle&&"production"!==s.lifecycle||console.debug("GamsWidget: WidgetDefinition's lifecycle was configured as:'",s.lifecycle,"' Set the lifecycle to 'deploy' if you want to remove the console messages."):console.debug("GamsWidget: WidgetDefinition's lifecycle not set. Defaulting to:'develop'. Set the lifecycle to 'deploy' if you want to remove the console messages."))}),[s]),r.a.createElement(r.a.Fragment,null,r.a.cloneElement(l,{widgetDef:v}),t?r.a.createElement(t.Component,Object.assign({},t.props,{globalPropName:n,datastream:o,setDefinition:d})):r.a.createElement(g,{setDefinition:d,globalPropName:n,datastream:o}),s?a?r.a.createElement(a.Component,Object.assign({widgetDef:s,setWidgetData:h},a.props)):r.a.createElement(m,{widgetDef:s,setWidgetData:h}):null)},h=a(10),b=a(3),E=function(e){var t=e.children,a=e.value,n=e.storageKey,o=e.onChange;return r.a.useEffect((function(){var e=localStorage.getItem(n);null===e&&(e=""),o&&o(e)}),[]),r.a.useEffect((function(){localStorage.setItem(n,a)}),[a]),r.a.createElement(r.a.Fragment,null,t)},y=function(e){var t=e.onChange,a=e.value,n=e.options,o=e.localStorageKey,l=e.placeHolder,i=void 0===l?void 0:l,c=e.prepend,u=Object(b.a)(e,["onChange","value","options","localStorageKey","placeHolder","prepend"]);return r.a.useEffect((function(){i||a&&t(n[0].value)}),[i]),r.a.createElement(r.a.Fragment,null,r.a.createElement(E,{onChange:function(e){return t(e)},storageKey:o,value:a},r.a.createElement("div",{className:"input-group mb-3"},c?r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text",id:"basic-addon1"},c)):null,r.a.createElement("select",Object.assign({value:a,onChange:function(e){return t(e.currentTarget.value)}},u),i?r.a.createElement("option",{key:"SelectFormGroup_option_-1",value:"",disabled:!0,hidden:!0},i):r.a.createElement("option",{key:"SelectFormGroup_option_-1",value:n[0].value,disabled:!0,hidden:!0},n[0].label),n.map((function(e,t){return r.a.createElement("option",{key:"SelectFormGroup_option_".concat(t),value:e.value},e.label)}))))))},w=function(e){var t=e.options,a=e.onChange,n=e.localStorageKey,o=r.a.useState((function(){var e=t.value.filter((function(e){return!0===e._selected}));return e.length>0?e[0].value:""})),l=Object(i.a)(o,2),c=l[0],u=l[1],s=function(e){u(e);var n=t.value.filter((function(t){return t.value===e})),r=n.length>0?n[0].value:"";a(r)};return r.a.createElement("div",{className:"form-group tripleform--selectformgroup"},t.label?r.a.createElement("label",null,t.label):null,r.a.createElement(y,{localStorageKey:n,onChange:function(e){return s(e)},useLocaleStorage:!0,options:t.value,value:c,placeHolder:t.placeHolder,className:"form-control",required:t.required,prepend:t.prepend}),t.small?r.a.createElement("small",{className:"form-text text-muted"},t.small):null)},S=function(e){var t=e.onChange,a=e.value,n=e.localStorageKey,o=Object(b.a)(e,["onChange","value","localStorageKey"]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(E,{storageKey:n,value:a,onChange:function(e){return t(e)}},r.a.createElement("input",Object.assign({onChange:function(e){return t(e.currentTarget.value)},value:a},o))))},D=function(e){var t=e.options,a=e.onChange,n=e.localStorageKey,o=r.a.useState(t.value),l=Object(i.a)(o,2),c=l[0],u=l[1];return r.a.useEffect((function(){void 0!==c&&"undefined"!==c&&null!==c&&a(c)}),[c]),r.a.useEffect((function(){if("text"!==t.type)throw new TypeError("Tried to generate a textInputFormGroup, which type is not set to 'text'. Input with label: ".concat(t.label));if("string"!==typeof t.value)throw new TypeError("You have to pass in a string, when the input type is set to 'text'. Error at input with label: ".concat(t.label))}),[]),r.a.createElement("div",{className:"form-group tripleform--textformgroup"},t.label?r.a.createElement("label",null,t.label):null,r.a.createElement(S,{localStorageKey:n,required:t.required,className:"form-control",type:"text",id:t.id,placeholder:t.placeHolder,value:t.value,onChange:function(e){return u(e)}}),t.small?r.a.createElement("small",{className:"form-text text-muted"},t.small):null)},O=a(9),j=a.n(O),G=function(e){var t=e.id,a=e.autoCompleteOption,n=e.onchange,o=e.localStorageKey,l=r.a.useState((function(){var e=a.value.filter((function(e){return!0===e._selected}));return e.length>0?e[0].label:""})),c=Object(i.a)(l,2),u=c[0],s=c[1],d=r.a.useState(u),f=Object(i.a)(d,2),m=f[0],p=f[1],g=r.a.useState([]),v=Object(i.a)(g,2),h=v[0],b=v[1],y=function(e){p(e),e===u&&(n(void 0),s(""));var t=e.trim().toLowerCase(),r=t.length;return"*"===e?a.value:0===r?[]:a.value.filter((function(e){return e.label?e.label.toLowerCase().slice(0,r)===t:void 0}))};r.a.useEffect((function(){if(u){var e=a.value.filter((function(e){return e.label===u}));e[0]&&n&&n(e[0].value)}}),[u]);var w={placeholder:a.placeHolder,value:u,onChange:function(e,t){var a=t.newValue;s(a)}};return r.a.createElement(E,{onChange:function(e){return s(e)},value:u,storageKey:o},r.a.createElement(j.a,{id:t,suggestions:h,onSuggestionsFetchRequested:function(e){var t=e.value;h=y(t);var a=Array.from(h);b((function(){return a}))},onSuggestionsClearRequested:function(){b([])},getSuggestionValue:function(e){return e.label},renderSuggestion:function(e){var t=m.length;return r.a.createElement("div",null,r.a.createElement("span",{style:{color:"red"}},e.label.substring(0,t)),r.a.createElement("span",null,e.label.substring(t,e.label.length)))},inputProps:w,renderInputComponent:function(e){return r.a.createElement("div",{className:"tripleform--autocomplete-formgroup form-group"},a.label?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null," ",a.label," "),r.a.createElement("br",null)):null,a.required?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"input-group mb-3 autocomplete--input-group"},a.prepend?r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text",id:"basic-addon1"},a.prepend)):null,r.a.createElement("input",Object.assign({className:"form-control",style:{borderBottom:"".concat(0!==a.value.filter((function(e){return e.label===u})).length?"":"2px solid #dc3545")},type:"text"},e))),a.small?r.a.createElement("small",{className:"form-text text-muted"},a.small):null):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"input-group mb-3 autocomplete--input-group"},a.prepend?r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text",id:"basic-addon1"},a.prepend)):null,r.a.createElement("input",Object.assign({className:"form-control",style:{border:"1px solid #28a745"},type:"text"},e))),a.small?r.a.createElement("small",{className:"form-text text-muted"},a.small):null))}}))},N=function(e){return JSON.parse(JSON.stringify(e))},x=function(){localStorage.clear(),window.location.reload()},P=function(e){var t=e.restPathGroups,a=e.inputIsValid,n=e.setInputFields,o=e.handleSearch,l=e.loading,c=void 0===l?void 0:l,u=e.searchBtns,s=function(e,a){if("text"===a.type){a.value=e;var r=N(t);return n?n((function(){return r})):null}Object(h.a)(a.value).forEach((function(t){return t._selected=t.value===e}));var o=N(t);return n?n((function(){return o})):null},d=function(e){if("object"!==typeof e.value)throw new TypeError("You have to pass in an array of objects if selected type of input is 'select'. Given input-label: ".concat(e.label));if(!Array.isArray(e.value))throw new TypeError("You have to pass in an array of objects if selected type of input is 'select'. Given input-label: ".concat(e.label));if(!e.value[0].label||!e.value[0].value)throw new TypeError("You have to pass in an array of objects if selected type of input is 'select'. Given input-label: ".concat(e.label))},f=r.a.useState(0),m=Object(i.a)(f,2),p=m[0],g=m[1];return r.a.useEffect((function(){var e=0,t=setInterval((function(){g(e+=.1),e>1&&clearInterval(t)}),40)}),[]),r.a.createElement("form",{className:"was-validated responsiveform",style:{opacity:p}},t.map((function(e){return r.a.createElement("div",{className:"responsive-form--form-block"}," ",e.formGroups.map((function(t){return"text"===t.type?function(e,t){var a="responsiveForm_TextFormGroup_".concat(t.indexOf(e),"_").concat(e.id);return r.a.createElement(D,{key:a,localStorageKey:a,options:e,onChange:function(t){return s(t,e)}})}(t,e.formGroups):"select"===t.type?function(e,t){d(e);var a="ResponsiveForm_SelectFormGroup_".concat(t.indexOf(e),"_").concat(e.id);return r.a.createElement(w,{key:a,localStorageKey:a,options:e,onChange:function(t){return s(t,e)}})}(t,e.formGroups):"autocomplete"===t.type?function(e,t){d(e);var a="ResponsiveForm_AutoComplete_".concat(t.indexOf(e),"_").concat(e.id);return r.a.createElement(G,{id:"".concat(1e3*Math.random()),key:a,autoCompleteOption:e,onchange:function(t){return s(t,e)},localStorageKey:a})}(t,e.formGroups):void 0})))})),r.a.createElement("div",{className:"responsive-form--form-block responsive-form--button-block"},r.a.createElement("button",{className:"btn ".concat(a?"btn-success":"btn-warning"),onClick:function(e){return o(e)}},u?u.searchText:"Suche"),r.a.createElement("button",{className:"btn btn-light",onClick:function(e){e.preventDefault(),x()}},u?u.resetText:"Suche zur\xfccksetzen"),r.a.createElement("div",{className:"spinner-border tripleform--spinner",style:{visibility:c?"inherit":"hidden"},role:"status"})))},W=function(e){var t=e.queryStart,a=e.query,n=e.paramDelimiter;return r.a.createElement("div",{className:"container"},r.a.createElement("br",null),r.a.createElement("h4",null,"Query Build Helper"),r.a.createElement("p",null,'(set lifecycle to "deploy" to deactivate builder) ',r.a.createElement("br",null),r.a.createElement("br",null),"Query-Start: ",r.a.createElement("br",null),t)," ",r.a.createElement("hr",null),r.a.createElement("p",null,"Decoded: ",r.a.createElement("br",null)," ",a)," ",r.a.createElement("hr",null),r.a.createElement("p",null,"Encoded:",r.a.createElement("br",null)," ",encodeURIComponent(a))," ",r.a.createElement("hr",null),r.a.createElement("p",null,"Given parameter-delimiter:",r.a.createElement("br",null)," ",n)," ")},C=function(e){var t=e.widgetDef,a=r.a.useState(""),n=Object(i.a)(a,2),o=n[0],l=n[1],c=r.a.useState(void 0),u=Object(i.a)(c,2),s=u[0],d=u[1],m=r.a.useState(void 0),p=Object(i.a)(m,2),g=p[0],v=p[1],h=r.a.useState(!1),b=Object(i.a)(h,2),E=b[0],y=b[1];r.a.useEffect((function(){t&&t.gui&&d(f(t.gui.params))}),[t]),r.a.useEffect((function(){if(t&&s){var e="";if(t.gui){var a=t.gui.parameterDelimiter;if(s.forEach((function(t){if(e.includes(t.restPathVariable))throw new TypeError("Found RestPathVariable a second time: ".concat(t.restPathVariable));"undefined"!==e&&e?e+="&".concat(t.restPathVariable,"="):e="".concat(t.restPathVariable,"="),t.formGroups.forEach((function(t,n){if("text"===t.type&&(e+="".concat(0===n?"":a).concat(t.parameter).concat(t.value)),"select"===t.type||"autocomplete"===t.type){if(!Array.isArray(t.value))throw new TypeError("Encountered a not array type inside an queryInput marked as 'select'. Input's label is: ".concat(t.label));t.value.forEach((function(r){!0===r._selected&&(e+="".concat(0===n?"":a).concat(t.parameter).concat(r.value))}))}}))})),"undefined"===e)return l("");l(e)}}}),[s]),r.a.useEffect((function(){if(t&&s)try{s.forEach((function(e){e.formGroups.forEach((function(e){if(!e.value&&e.required)throw new TypeError;if(Array.isArray(e.value)&&e.required){var t=!1;if(e.value.forEach((function(e){!0===e._selected&&(t=!0)})),!t)throw new TypeError}}))})),v(!0)}catch(e){v(!1)}}),[o]);return r.a.createElement("div",{className:"tripleform"},t&&t.gui&&s?r.a.createElement(r.a.Fragment,null,r.a.createElement(P,{restPathGroups:s,setInputFields:d,handleSearch:function(e){if(t){if(e.preventDefault(),!o)return alert("w\xe4hlen Sie einen g\xfcltigen Wert f\xfcr die Suche aus.");if(!s)throw new TypeError("Cannot start a search without any formGroups defined for the tripleForm!");if(!g)return alert("Bitte w\xe4hlen Sie f\xfcr alle Suchfelder einen g\xfcltigen Wert aus.");if(t.gui){var a=t.gui.queryStart+o;y(!0),window.location.href=encodeURI(a)}}},inputIsValid:g,loading:E,searchBtns:t.gui.searchBtns}),t.lifecycle&&"develop"===t.lifecycle?r.a.createElement(W,{query:o,queryStart:t.gui.queryStart,paramDelimiter:t.gui.parameterDelimiter}):null):null)},T=function(){return r.a.createElement(v,{datastream:"GAMS_WIDGET_TRIPLEFORM",globalPropName:"GAMS_WIDGET_TRIPLEFORM"},r.a.createElement(C,null))};l.a.render(r.a.createElement(T,null),document.getElementById("GAMS_WIDGET_TRIPLEFORM"))}},[[11,1,2]]]);
//# sourceMappingURL=main.e181e5a1.chunk.js.map